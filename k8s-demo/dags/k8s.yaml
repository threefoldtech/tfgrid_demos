steps:
  - name: terraform version
    command: terraform version

  # initializing terraform provider plugins
  - name: terraform init
    command: terraform init
    dir: deployment
    depends:
      - terraform version

  # deploy k8s cluster using terraform
  - name: terraform apply
    command: terraform apply -auto-approve
    dir: deployment
    depends:
      - terraform init

  # clean up after deployment is done
  - name: terraform destroy
    command: terraform destroy -auto-approve
    dir: deployment
    depends:
      - terraform apply
